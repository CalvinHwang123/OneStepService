<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="oss.mapper.BusiManageMapper">
	<!-- 华清修改：需求管理列表查询 -->
	<select id="demandList" parameterType="oss.bean.Condition" resultType="oss.bean.Demands">
		select * from demands where 1 = 1
		
		<if test="startDate != null and endDate != null and startDate != '' and endDate != ''">
			and releaseTime between '${startDate} 00:00:00' and '${endDate} 23:59:59'
		</if>
		<if test="title != null and title != ''">
			and demandID like '%${title}%'
		</if>
	</select>
	
	
	
	
	<!-- 华清修改：需求管理审核通过 -->
	<update id="examine" parameterType="long">
	update  demands set demandstatusid = 2 where demandID=#{demandID}
	</update>
	<!-- 华清修改：需求管理审核不通过 -->
	<update id="Audited" parameterType="long">
	update  demands set demandstatusid = 3 where demandID=#{demandID}
	</update>
	
	
	<!--  by hsp 发布需求 	 -->
	<insert id="insertDemand" parameterType="oss.bean.Demands">
		<selectKey keyProperty="demandID" order="BEFORE" resultType="java.lang.Long" >
			select DEMANDSEQ.nextval  from dual 
		</selectKey>
		insert into demands 
		(demandID,classificationID,userID,demandstatusid,demandTitle,demandContent,releaseTime
		,asoftTime,demandPrice,tenderNumber) values 
		(#{demandID},#{classificationID},#{userID},#{demandstatusid},#{demandTitle},#{demandContent}
		,#{releaseTime},#{asoftTime},#{demandPrice},#{tenderNumber})
	</insert>
	
	
</mapper>
